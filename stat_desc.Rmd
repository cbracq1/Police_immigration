---
title: "Premières statistiques descriptives"
author: "Bracq, Raymond"
date: "28/11/2023"
output:
  html_notebook: 
    encoding: UTF-8
  pdf_document: default
  html_document:
    df_print: paged
    encoding: UTF-8
editor_options:
  markdown:
    wrap: 72
---

# Projet DSSS : Police et immigration{.tabset .tabset-fade}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r libraries, include = FALSE}
library(haven)#si t'as pas les packages il faut faire install.packages("nom du package") dans la console
library(tidyverse)
library(dplyr)
library(labelled)
library(survey)
library(arrow)
library(ggplot2)
library(questionr)
```


```{r bases, include = FALSE}
if (!exists("indiv")) {
  indiv <- read_sas("C:/Users/Utilisateur/Documents/GitHub/Police_immigration/TeO2/SAS/indiv.sas7bdat",  catalog_file = "C:/Users/Utilisateur/Documents/GitHub/Police_immigration/TeO2/Doc/formats.sas7bcat")# ça c'est mon chemin, soit tu organises ton truc de la même manière comme ça ça marche pour nous deux soit il faut que tu fasses une autre commande
  indiv <- to_factor(indiv)}

if (!exists("indiv_pd")) {
  indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)}# objet survey, pour prendre en compte les pondérations pour certaines fonctions

```

## Recodage

ok: 
i_cnfpol, i_cnfjus, i_ecole, i_contri

à faire :
group1, durée de séjour, génération et origine (origine_tous_g2), relations dans le quartier, sécurité du quartier, i_controla, i_controlb, âge (agenq), sexe (sexee), QPV, indicateurs niveau socioéco, i_opipol


```{r}


## Recodage de indiv$i_cnfpol en indiv$i_cnfpol_rec
indiv$i_cnfpol_rec <- as.character(indiv$i_cnfpol)
indiv$i_cnfpol_rec <- fct_recode(indiv$i_cnfpol_rec,
  "Tout à fait confiance en la police" = "1",
  "Plutôt confiance en la police" = "2",
  "Plutôt pas confiance en la police" = "3",
  "Pas du tout confiance" = "4",
  "Refus ou ne sait pas" = "8",
  "Refus ou ne sait pas" = "9"
)

## Recodage de indiv$i_ecole en indiv$i_ecole_rec
indiv$i_ecole_rec <- as.character(indiv$i_ecole)
indiv$i_ecole_rec <- fct_recode(indiv$i_ecole_rec,
  "Tout à fait confiance en l'école" = "1",
  "Plutôt confiance en l'école" = "2",
  "Plutôt pas confiance en l'école" = "3",
  "Pas du tout confiance en l'école" = "4",
  "Refus ou ne sait pas" = "8",
  "Refus ou ne sait pas" = "9"
)

## Recodage de indiv$i_cnfjus en indiv$i_cnfjus_rec
indiv$i_cnfjus_rec <- as.character(indiv$i_cnfjus)
indiv$i_cnfjus_rec <- fct_recode(indiv$i_cnfjus_rec,
  "Tout à fait confiance en la justice" = "1",
  "Plutôt confiance en la justice" = "2",
  "Plutôt pas confiance en la justice" = "3",
  "Pas du tout confiance en la justice" = "4",
  "Refus ou ne sait pas" = "8",
  "Refus ou ne sait pas" = "9"
)

## Recodage de indiv$i_contri en indiv$i_contri_rec
indiv$i_contri_rec <- as.character(indiv$i_contri)
indiv$i_contri_rec <- fct_recode(indiv$i_contri_rec,
  "Jamais" = "1",
  "Une seule fois" = "2",
  "De 2 à 5 fois" = "3",
  "Plus de 5 fois" = "4",
  "Refus ou ne sait pas" = "8",
  "Refus ou ne sait pas" = "9"
)

```


## Confiance en la police
La variable d'intérêt est i_cnfpol :
Avez-vous confiance dans les institutions suivantes en France : la police

```{r, echo = FALSE}
svytable(~i_cnfpol + group1, indiv_pd)
```
```{r}
ggsurvey(indiv_pd, aes(x = as.factor(group1), y = as.factor(i_cnfpol), fill = as.factor(i_cnfpol)))+
  geom_bar(stat = "identity")
```
Paramètres à regarder : durée de séjour, génération et origine (origine_tous_g2), relations dans le quartier, sécurité du quartier



## Discriminations
Les variables d'intérêt sont i_contri, i_controla, i_controlb.

## Confiance et discriminations

Discrimination

