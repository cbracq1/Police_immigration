library(ggplot2)
library(questionr)
source("Base.R")
stable <- svytable(~i_cnfpol_rec + group1_rec, indiv_pd)
indiv$group1_code <- as.character(indiv$group1)
indiv$group1_code <- fct_recode(indiv$group1_code,
"G1_I" = "1",
"G1_OM" = "2",
"G2_I" = "3",
"G2_OM" = "4",
"Autre" = "5"
)
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
ggsurvey(indiv_pd, aes(x = as.factor(group1_code), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
#ggsurvey(indiv_pd, aes(x = as.factor(group1_rec), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
#  geom_bar(stat = "identity")
#Si il faut faire une repondération :
tb1 <- data.frame(cprop(svytable(~i_cnfpol_rec+group1_code, indiv_pd[which(indiv_pd$variables$i_cnfpol_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_cnfpol_rec != "Total")
ggplot(tb2, aes(x = group1_code, y= Freq, fill = i_cnfpol_rec)) +
geom_bar(stat="identity")
coloration = c("red","orange","purple","blue","green")
group_un = c("G1_I","G2_I","G1_OM","G2_OM","Autre")
df = data.frame(X = 1:100)
for (i in 1:5){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
g = group_un[i]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = filter(indiv,group1_code == g)
X = 1:100
Y = c()
for (x in X){
datax = filter(data,durar2==x & data$i_cnfpol_rec != "Refus ou ne sait pas")
datax_obj = filter(datax,i_cnfpol_rec == "Tout à fait confiance en la police")
n_tot = sum(datax$poidsi)
n_obj = sum(datax_obj$poidsi)
if (n_tot == 0){
Y = c(Y,0)
}
else{
Y=c(Y,n_obj/n_tot)
}
}
df[paste(g,"_","Y",sep="")] = Y
}
#ggplot(df,aes(x = duree_de_sejour, y = pourcentage_de_confiance))+geom_smooth()
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
legend(50,1,legend=c("G1-I","G2-I","Autre","G2-OM","G2-I"),col=c("red","orange","green","blue","purple"),lty=c(1,1,1,1,1,1),cex=0.8)
#par(new=T)
ggplot(df,aes(x =X))+
geom_point(aes(y = G1_I_Y),color="red", alpha = 0.5)+
geom_point(aes(y=Autre_Y),color="green", alpha = 0.5)+
geom_point(aes(y = G2_I_Y),color="orange", alpha = 0.5)+
geom_point(aes(y = G1_OM_Y),color="purple", alpha = 0.5)+
geom_point(aes(y = G2_OM_Y),color="blue", alpha = 0.5)+
geom_smooth(aes(y = G1_I_Y),color="red")+
geom_smooth(aes(y = G2_I_Y),color="orange")+
geom_smooth(aes(y = G1_OM_Y),color="purple")+
geom_smooth(aes(y = G2_OM_Y),color="blue")+
geom_smooth(aes(y=Autre_Y),color="green")
coloration = c("red","orange","green","blue")
l_age_inf = c(18,30,40,50)
l_age_sup = c(29,39,49,59)
for (i in 1:6){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = filter(indiv,group1_code == g & indiv$agenq >= age_inf & indiv$agenq <= age_sup)
X = 1:100
Y = c()
for (x in X){
datax = filter(data,durar2==x & data$i_cnfpol_rec != "Refus ou ne sait pas")
datax_obj = filter(datax,i_cnfpol_rec == "Tout à fait confiance en la police")
n_tot = sum(datax$poidsi)
n_obj = sum(datax_obj$poidsi)
if (n_tot == 0){
Y = c(Y,0)
}
else{
Y=c(Y,n_obj/n_tot)
}
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
#ggplot(indiv,aes(x=duree,y=taux))+geom_smooth()
legend(50,1,legend=c("> 18 et < 30 ans","> 30 et < 40 ans","> 40 et < 50 ans","> 50 et < 60 ans"),col=c("red","orange","green","blue"),lty=c(1,1,1,1,1,1),cex=0.8)
par(new=T)
}
#présence d'immigrés dans le quartier (l_immi)
#indiv$l_immi
#indiv$l_immi_rec
## Recodage de indiv$l_immi en indiv$l_immi_rec
indiv$l_immi_code <- as.character(indiv$l_immi)
indiv$l_immi_code <- fct_recode(indiv$l_immi_code,
"Tous" = "1",
"sup 50%" = "2",
"eq 50%" = "3",
"inf 50%" = "4",
"Aucun" = "5",
"null" = "8",
"null" = "9")
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
ggsurvey(indiv_pd, aes(x = as.factor(l_immi_code), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
tb1 <- data.frame(cprop(svytable(~i_cnfpol_rec+l_immi_code, indiv_pd[which(indiv_pd$variables$i_cnfpol_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_cnfpol_rec != "Total")
ggplot(tb2, aes(x = l_immi_code, y= Freq, fill = i_cnfpol_rec)) +
geom_bar(stat="identity")
#relations dans le quartier (a_rquart) (avec combien de personnes de ton quartier, es-tu ami ?)
#indiv$a_rquart_rec
## Recodage de indiv$l_immi en indiv$l_immi_rec
indiv$a_rquart_code <- as.character(indiv$a_rquart)
indiv$a_rquart_code <- fct_recode(indiv$a_rquart_code,
"Tous" = "1",
"sup 50%" = "2",
"eq 50%" = "3",
"inf 50%" = "4",
"Aucun" = "5",
"null" = "8",
"null" = "9")
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
ggsurvey(indiv_pd, aes(x = as.factor(a_rquart_code), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
tb1 <- data.frame(cprop(svytable(~i_cnfpol_rec+a_rquart_code, indiv_pd[which(indiv_pd$variables$i_cnfpol_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_cnfpol_rec != "Total")
ggplot(tb2, aes(x = a_rquart_code, y= Freq, fill = i_cnfpol_rec)) +
geom_bar(stat="identity")
#sécurité du quartier(l_quart_secu)
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
ggsurvey(indiv_pd, aes(x = as.factor(l_quart_secu_rec), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
tb1 <- data.frame(cprop(svytable(~i_cnfpol_rec+l_quart_secu_rec, indiv_pd[which(indiv_pd$variables$i_cnfpol_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_cnfpol_rec != "Total")
ggplot(tb2, aes(x = l_quart_secu_rec, y= Freq, fill = i_cnfpol_rec)) +
geom_bar(stat="identity")
#Vivre dans un QPV (qpv_i)
group_qpv = rep("null",dimension[1])
group_qpv[which(indiv$qpv_i == 0 & indiv$group1_code=="G1-I")] = "G1-I out QPV"
group_qpv[which(indiv$qpv_i == 1 & indiv$group1_code=="G1-I")] = "G1-I in QPV"
group_qpv[which(indiv$qpv_i == 0 & indiv$group1_code=="G2-I")] = "G2-I out QPV"
group_qpv[which(indiv$qpv_i == 1 & indiv$group1_code=="G2-I")] = "G2-I in QPV"
group_qpv[which(indiv$qpv_i == 0 & indiv$group1_code=="Autre")] = "Autre out QPV"
group_qpv[which(indiv$qpv_i == 1 & indiv$group1_code=="Autre")] = "Autre in QPV"
indiv["group_QPV"] = group_qpv
ggsurvey(indiv_pd, aes(x = as.factor(group_QPV), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
tb1 <- data.frame(cprop(svytable(~i_cnfpol_rec+group_QPV, indiv_pd[which(indiv_pd$variables$i_cnfpol_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_cnfpol_rec != "Total")
ggplot(tb2, aes(x = group_QPV, y= Freq, fill = i_cnfpol_rec)) +
geom_bar(stat="identity")
tb1 <- data.frame(cprop(svytable(~i_cnfpol_rec+qpv_i_rec, indiv_pd[which(indiv_pd$variables$qpv_i_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_cnfpol_rec != "Total")
ggplot(tb2, aes(x = qpv_i_rec, y= Freq, fill = i_cnfpol_rec)) +
geom_bar(stat="identity")
#group_1 :
ggsurvey(indiv_pd, aes(x = as.factor(group1_code), y = as.factor(i_contri_rec), fill = as.factor(i_contri_rec)))+
geom_bar(stat = "identity")
tb1 <- data.frame(cprop(svytable(~i_contri_rec+group1_code, indiv_pd[which(indiv_pd$variables$i_contri_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_contri_rec != "Total")
ggplot(tb2, aes(x = group1_code, y= Freq, fill = i_contri_rec)) +
geom_bar(stat="identity")
#présence d'immigrés dans le quartier (l_immi)
ggsurvey(indiv_pd, aes(x = as.factor(l_immi_code), y = as.factor(i_contri_rec), fill = as.factor(i_contri_rec)))+
geom_bar(stat = "identity")
tb1 <- data.frame(cprop(svytable(~i_contri_rec+l_immi_code, indiv_pd[which(indiv_pd$variables$i_contri_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_contri_rec != "Total")
ggplot(tb2, aes(x = l_immi_code, y= Freq, fill = i_contri_rec)) +
geom_bar(stat="identity")
#sécurité du quartier(l_quart_secu)
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
ggsurvey(indiv_pd, aes(x = as.factor(l_quart_secu_rec), y = as.factor(i_contri_rec), fill = as.factor(i_contri_rec)))+
geom_bar(stat = "identity")
tb1 <- data.frame(cprop(svytable(~i_contri_rec+l_quart_secu_rec, indiv_pd[which(indiv_pd$variables$i_contri_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_contri_rec != "Total")
ggplot(tb2, aes(x = l_quart_secu_rec, y= Freq, fill = i_contri_rec)) +
geom_bar(stat="identity")
#Vivre dans un QPV (qpv_i)
ggsurvey(indiv_pd, aes(x = as.factor(group_QPV), y = as.factor(i_contri_rec), fill = as.factor(i_contri_rec)))+
geom_bar(stat = "identity")
tb1 <- data.frame(cprop(svytable(~i_contri_rec+group_QPV, indiv_pd[which(indiv_pd$variables$i_contri_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_contri_rec != "Total")
ggplot(tb2, aes(x = group_QPV, y= Freq, fill = i_contri_rec)) +
geom_bar(stat="identity")
tb1 <- data.frame(cprop(svytable(~i_contri_rec+qpv_i_rec, indiv_pd[which(indiv_pd$variables$qpv_i_rec != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_contri_rec != "Total")
ggplot(tb2, aes(x = qpv_i_rec, y= Freq, fill = i_contri_rec)) +
geom_bar(stat="identity")
#group_1 :
tb1 <- data.frame(cprop(svytable(~i_control_rec_a+group1_code, indiv_pd[which(indiv_pd$variables$i_control_rec_a != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_control_rec_a != "Total")
ggplot(tb2, aes(x = group1_code, y= Freq, fill = i_control_rec_a)) +
geom_bar(stat="identity")+
ggtitle("Ils vous ont expliqué ce qu'ils faisaient et pourquoi")
tb1 <- data.frame(cprop(svytable(~i_control_rec_b+group1_code, indiv_pd[which(indiv_pd$variables$i_control_rec_b != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_control_rec_b != "Total")
ggplot(tb2, aes(x = group1_code, y= Freq, fill = i_control_rec_b)) +
geom_bar(stat="identity")+
ggtitle("Ils ont été polis")
tb1 <- data.frame(cprop(svytable(~i_control_rec_c+group1_code, indiv_pd[which(indiv_pd$variables$i_control_rec_c != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_control_rec_c != "Total")
ggplot(tb2, aes(x = group1_code, y= Freq, fill = i_control_rec_c)) +
geom_bar(stat="identity")+
ggtitle("Ils vous ont tutoyé")
tb1 <- data.frame(cprop(svytable(~i_control_rec_d+group1_code, indiv_pd[which(indiv_pd$variables$i_control_rec_d != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_control_rec_d != "Total")
ggplot(tb2, aes(x = group1_code, y= Freq, fill = i_control_rec_d)) +
geom_bar(stat="identity")+
ggtitle("Ils ont fouillé vos vêtements et vos sacs")
tb1 <- data.frame(cprop(svytable(~i_control_rec_e+group1_code, indiv_pd[which(indiv_pd$variables$i_control_rec_e != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_control_rec_e != "Total")
ggplot(tb2, aes(x = group1_code, y= Freq, fill = i_control_rec_e)) +
geom_bar(stat="identity")+
ggtitle("Ils vous ont provoqué, insulté")
tb1 <- data.frame(cprop(svytable(~i_control_rec_f+group1_code, indiv_pd[which(indiv_pd$variables$i_control_rec_f != "Refus ou ne sait pas")])))
tb2 <- filter(tb1,i_control_rec_f != "Total")
ggplot(tb2, aes(x = group1_code, y= Freq, fill = i_control_rec_f)) +
geom_bar(stat="identity")+
ggtitle("Ils ont été brutaux")
---
title: "Premières statistiques descriptives"
---
title: "ACM et Arbre de décision"
---
title: "Premières statistiques descriptives"
knitr::opts_chunk$set(echo = TRUE)
library(haven)
library(tidyverse)
library(dplyr)
library(labelled)
library(survey)
library(arrow)
library(ggplot2)
library(questionr)
source("Base.R")
source("stat_desc.Rmd")
indiv$origine_tous_g2_cont <- fct_recode(indiv$origine_tous_g2_cont,
"Sans ascendance direct" = "0",
"G1 français ne hors de France métro" = "10",
"G2 français ne hors de France métro" = "11",
"G1 d'Outre-mer" = "20",
"G2 d'Outre-mer" = "22",
"G1 Afrique" = "30",
"G2 Afrique" = "33",
"G1 Afrique" = "40",
"G2 Afrique" = "44",
"G1 Afrique" = "50",
"G2 Afrique" = "55",
"G1 Afrique" = "60",
"G2 Afrique" = "66",
"G1 Afrique" = "70",
"G2 Afrique" = "77",
"G1 Asie" = "80",
"G2 Asie" = "88",
"G1 Asie" = "90",
"G2 Asie" = "99",
"G1 Asie" = "100",
"G1 Asie" = "110",
"G2 Asie" = "111",
"G1 Europe" = "120",
"G2 Europe" = "121",
"G1 Europe" = "130",
"G2 Europe" = "131",
"G1 Europe" = "140",
"G2 Europe" = "141",
"G1 Europe" = "150",
"G2 Europe" = "151",
"G1 Autre" = "160",
"G2 Autre" = "161"
)
indiv$origine_tous_g2_class <- fct_recode(indiv$origine_tous_g2_class,
"Sans ascendance direct" = "0",
"G1 français ne hors de France métro" = "10",
"G2 français ne hors de France métro" = "11",
"G1 d'Outre-mer" = "20",
"G2 d'Outre-mer" = "22",
"G1 Maghreb" = "30",
"G2 Maghreb" = "33",
"G1 Maghreb" = "40",
"G2 Maghreb" = "44",
"G1 Sahel" = "50",
"G2 Sahel" = "55",
"G1 Guinée" = "60",
"G2 Guinée" = "66",
"G1 Afrique" = "70",
"G2 Afrique" = "77",
"G1 Asie" = "80",
"G2 Asie" = "88",
"G1 Trurquie/Moyen-Orient" = "90",
"G2 Turquie/Moyen-Orient" = "99",
"G1 Chine" = "100",
"G1 Asie" = "110",
"G2 Asie" = "111",
"G1 Europe" = "120",
"G2 Europe" = "121",
"G1 Europe" = "130",
"G2 Europe" = "131",
"G1 Europe" = "140",
"G2 Europe" = "141",
"G1 Europe" = "150",
"G2 Europe" = "151",
"G1 Autre" = "160",
"G2 Autre" = "161"
)
## Recodage de indiv$origine_tous_g2 en indiv$origine_tous_g2_class
indiv$origine_tous_g2_class <- as.character(indiv$origine_tous_g2)
indiv$origine_tous_g2_class <- fct_recode(indiv$origine_tous_g2_class,
"Sans ascendance direct" = "0",
"G1 français ne hors de France métro" = "10",
"G2 français ne hors de France métro" = "11",
"G1 d'Outre-mer" = "20",
"G2 d'Outre-mer" = "22",
"G1 Maghreb" = "30",
"G2 Maghreb" = "33",
"G1 Maghreb" = "40",
"G2 Maghreb" = "44",
"G1 Sahel" = "50",
"G2 Sahel" = "55",
"G1 Guinée" = "60",
"G2 Guinée" = "66",
"G1 Afrique" = "70",
"G2 Afrique" = "77",
"G1 Asie" = "80",
"G2 Asie" = "88",
"G1 Trurquie/Moyen-Orient" = "90",
"G2 Turquie/Moyen-Orient" = "99",
"G1 Chine" = "100",
"G1 Asie" = "110",
"G2 Asie" = "111",
"G1 Europe" = "120",
"G2 Europe" = "121",
"G1 Europe" = "130",
"G2 Europe" = "131",
"G1 Europe" = "140",
"G2 Europe" = "141",
"G1 Europe" = "150",
"G2 Europe" = "151",
"G1 Autre" = "160",
"G2 Autre" = "161"
)
## Recodage de indiv$origine_tous_g2 en indiv$origine_tous_g2_class
indiv$origine_tous_g2_cont <- as.character(indiv$origine_tous_g2)
indiv$origine_tous_g2_cont <- fct_recode(indiv$origine_tous_g2_cont,
"Sans ascendance direct" = "0",
"G1 français ne hors de France métro" = "10",
"G2 français ne hors de France métro" = "11",
"G1 d'Outre-mer" = "20",
"G2 d'Outre-mer" = "22",
"G1 Afrique" = "30",
"G2 Afrique" = "33",
"G1 Afrique" = "40",
"G2 Afrique" = "44",
"G1 Afrique" = "50",
"G2 Afrique" = "55",
"G1 Afrique" = "60",
"G2 Afrique" = "66",
"G1 Afrique" = "70",
"G2 Afrique" = "77",
"G1 Asie" = "80",
"G2 Asie" = "88",
"G1 Asie" = "90",
"G2 Asie" = "99",
"G1 Asie" = "100",
"G1 Asie" = "110",
"G2 Asie" = "111",
"G1 Europe" = "120",
"G2 Europe" = "121",
"G1 Europe" = "130",
"G2 Europe" = "131",
"G1 Europe" = "140",
"G2 Europe" = "141",
"G1 Europe" = "150",
"G2 Europe" = "151",
"G1 Autre" = "160",
"G2 Autre" = "161"
)
install.packages("rpart.plot") #pour l'arbre de décision
library(rpart.plot)
library(rpart)
library(rpart.plot)
indiv$i_cnfpol
indiv$i_cnfpol_rec
indiv["i_cnfpol_1"] = (indiv$i_cnfpol == 1)*1
indiv$i_cnfpol_1
data = select(indiv,c(i_cnfpol_1,agenq, durar2, group1_code,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_quart_code))
knitr::opts_chunk$set(echo = TRUE)
library(haven)
library(tidyverse)
library(dplyr)
library(labelled)
library(survey)
library(arrow)
library(ggplot2)
library(questionr)
install.packages("rpart.plot") #pour l'arbre de décision
library(rpart)
library(rpart.plot)
source("Base.R")
install.packages("rpart.plot")
indiv["i_cnfpol_1"] = (indiv$i_cnfpol == 1)*1
data = select(indiv,c(i_cnfpol_1,agenq, durar2, group1_code,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_quart_code))
column(indiv)
data = select(indiv,c(i_cnfpol_1,agenq, durar2, group1_code,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
data
fit <- rpart(i_cnfpol_1~., data = data, method = 'class')
rpart.plot(fit, extra = 106)
rpart.plot(fit, extra = 101)
6
rpart.plot(fit, extra = 106)
fit <- rpart(i_cnfpol_1~., data = data, method = 'class')
rpart.plot(fit, extra = 106)
fit <- rpart(i_cnfpol_1~, data = data, method = 'class')
data = select(indiv,c(i_cnfpol_1,agenq, durar2, group1_code,group2_class,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
data = select(indiv,c(i_cnfpol_1,agenq, durar2, group1_code,origine_tous_g2_class,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
fit <- rpart(i_cnfpol_1~., data = data, method = 'class')
rpart.plot(fit, extra = 106)
fit <- rpart(i_cnfpol_1~group1_code, data = data, method = 'class')
rpart.plot(fit, extra = 106)
fit <- rpart(i_cnfpol_1~group1_code + durar2, data = data, method = 'class')
rpart.plot(fit, extra = 106)
install.packages("rpart") #pour l'arbre de décision
install.packages("rpart")
install.packages("rpart") #pour l'arbre de décision
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
knitr::opts_chunk$set(echo = TRUE)
library(haven)
library(tidyverse)
library(dplyr)
library(labelled)
library(survey)
library(arrow)
library(ggplot2)
library(questionr)
install.packages("rpart") #pour l'arbre de décision
library(rpart)
install.packages("rpart.plot")
library(rpart.plot)
source("Base.R")
data = select(indiv,c(i_cnfpol_1,agenq, durar2, group1_code,origine_tous_g2_class,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
indiv["i_cnfpol_1"] = (indiv$i_cnfpol == 1)*1
data = select(indiv,c(i_cnfpol_1,agenq, durar2, group1_code,origine_tous_g2_class,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
fit <- rpart(i_cnfpol_1~group1_code + durar2, data = data, method = 'class')
rpart.plot(fit, extra = 106)
fit <- rpart(i_cnfpol_1~., data = data, method = 'class')
rpart.plot(fit, extra = 106)
data = select(indiv,c(agenq, durar2, group1_code,origine_tous_g2_class,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
fit <- rpart(indiv$i_cnfpol_1~., data = data, method = 'class')
rpart.plot(fit, extra = 106)
indiv["i_cnfpol_1"] = (indiv$i_cnfpol == 1)*1
data = select(indiv,c(agenq, durar2, group1_code,origine_tous_g2_class,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
fit <- rpart(indiv$i_cnfpol_1~., data = data, method = 'class')
rpart.plot(fit, extra = 106)
fit <- rpart(indiv$i_cnfpol_1~., data = data, method = 'anova')
rpart.plot(fit, extra = 106)
rpart.plot(fit, extra = 0)
rpart.plot(fit, extra = 10)
rpart.plot(fit, extra = 100)
fit <- rpart(indiv$i_cnfpol_1~., data = data, method = 'anova')
fit <- rpart(indiv$i_cnfpol_1~., data = data, method = 'anova')
rpart.plot(fit, extra = 100)
rpart.plot(fit, extra = 10)
rpart.plot(fit, extra = 2)
rpart.plot(fit, extra = 100)
fit <- rpart(indiv$i_cnfpol_1~., data = data, method = 'class')
rpart.plot(fit, extra = 100)
rpart.plot(fit, extra = 106)
rpart.plot(fit, type = 0, extra = 106)
rpart.plot(fit, type = 0, extra = 104)
fit <- rpart(indiv$i_cnfpol_1~., data = data, method = 'anova')
rpart.plot(fit, type = 0, extra = 104)
rpart.plot(fit, type = 0, extra = 100)
rpart.plot(fit, type = 1, extra = 100)
rpart.plot(fit, type = 2, extra = 100)
rpart.plot(fit, type = 3, extra = 100)
rpart.plot(fit, type = 4, extra = 100)
rpart.plot(fit, type = 5, extra = 100)
fit
indiv["i_cnfpol_1"] = (indiv$i_cnfpol == 1)*1
data = select(indiv,c(agenq, durar2, group1_code,origine_tous_g2_cont,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
fit <- rpart(indiv$i_cnfpol_1~., data = data, method = 'anova')
rpart.plot(fit, type = 5, extra = 100)
fit
fit <- rpart(indiv$i_cnfpol_1~., data = data, method = 'class')
rpart.plot(fit, type = 5, extra = 100)
fit
rpart.plot(fit, type = 0, extra = 100)
rpart.plot(fit, type = 2, extra = 100)
rpart.plot(fit, type = 1, extra = 100)
data = select(indiv,c(i_cnfpol_1,agenq, durar2, group1_code,origine_tous_g2_cont,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
fit <- rpart(i_cnfpol_1~., data = data, method = 'class')
rpart.plot(fit, type = 1, extra = 100)
rpart.plot(fit, type = 5, extra = 100)
fit <- rpart(i_cnfpol_1~., data = data, method = 'avena')
fit <- rpart(i_cnfpol_1~., data = data, method = 'anova')
rpart.plot(fit, type = 5, extra = 100)
prp(fit,extra=1)
#data = select(indiv,c(i_cnfpol_1,agenq, durar2, group1_code,origine_tous_g2_cont,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
data = select(indiv,c(i_cnfpol_1,agenq, durar2,i_contri_rec,l_quart_secu_rec,l_immi_code,qpv_i,a_rquart_code))
fit <- rpart(i_cnfpol_1~., data = data, method = 'anova')
rpart.plot(fit, type = 5, extra = 100)
prp(fit,extra=1)
rpart.plot(fit, type = 5, extra = 100)
rpart.plot(fit, type = 2, extra = 100)
fit <- rpart(i_cnfpol_1~., data = data, method = 'class')
rpart.plot(fit, type = 2, extra = 106)
fit <- rpart(i_cnfpol_1~., data = data, method = 'anova')
rpart.plot(fit, type = 2, extra = 106)
rpart.plot(fit, type = 2, extra = 1)
