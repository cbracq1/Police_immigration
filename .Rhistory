par(new=T)
}
coloration = c("red","orange","purple","blue","green")
group_un = c("G1-I","G2-I","G1-OM","G2-OM","Autre")
for (i in 1:5){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
g = group_un[i]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
par(new=T)
}
for (i in 1:5){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
g = group_un[i]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
par(new=T)
}
age_inf = 30
age_sup = 50
for (i in 1:5){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
g = group_un[i]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
par(new=T)
}
for (i in 1:2){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
g = group_un[i]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
par(new=T)
}
for (i in 1:1){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
g = group_un[i]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
par(new=T)
}
coloration = c("red","green","blue")
l_age_inf = c(0,30,50)
l_age_sup = c(29,49,100)
for (i in 1:3){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
par(new=T)
}
legend(0,150,legend=c("a moins de 29 ans","a entre 30 et 49 ans","a plus de 50 ans"),col=c("red","green","blue"),lty=c(1,1,1),cex=0.8)
for (i in 1:3){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
par(new=T)
}
legend(0,150,legend=c("a moins de 29 ans","a entre 30 et 49 ans","a plus de 50 ans"),col=c("red","green","blue"),lty=c(1,1,1),cex=0.8)
legend(0,0.8,legend=c("a moins de 29 ans","a entre 30 et 49 ans","a plus de 50 ans"),col=c("red","green","blue"),lty=c(1,1,1),cex=0.8)
plot(c(-1),c(-1))
legend(0,0.8,legend=c("a moins de 29 ans","a entre 30 et 49 ans","a plus de 50 ans"),col=c("red","green","blue"),lty=c(1,1,1),cex=0.8)
plot(c(-1),c(-1))
coloration = c("red","green","blue")
l_age_inf = c(0,30,50)
l_age_sup = c(29,49,100)
for (i in 1:3){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
par(new=T)
}
plot(c(-1),c(-1))
for (i in 1:3){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
par(new=T)
}
legend(0,0.8,legend=c("a moins de 29 ans","a entre 30 et 49 ans","a plus de 50 ans"),col=c("red","green","blue"),lty=c(1,1,1),cex=0.8)
for (i in 1:3){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
legend(0,0.8,legend=c("a moins de 29 ans","a entre 30 et 49 ans","a plus de 50 ans"),col=c("red","green","blue"),lty=c(1,1,1),cex=0.8)
par(new=T)
}
for (i in 1:3){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
legend(0,0.9,legend=c("a moins de 29 ans","a entre 30 et 49 ans","a plus de 50 ans"),col=c("red","green","blue"),lty=c(1,1,1),cex=0.8)
par(new=T)
}
for (i in 1:3){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
legend(0,1,legend=c("a moins de 29 ans","a entre 30 et 49 ans","a plus de 50 ans"),col=c("red","green","blue"),lty=c(1,1,1),cex=0.8)
par(new=T)
}
ggsurvey(indiv_pd2, aes(x = as.factor(group1_code), y = nouv_pond, fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
indiv$qpv_i
indiv$qpv_i_rec
group_qpv = rep("null",dimension[1])
group_qpv[which(indiv$qpv_i == 0 & group1_code="G1-I")] = "G1-I out QPV"
group_qpv[which(indiv$qpv_i == 0 & group1_code=="G1-I")] = "G1-I out QPV"
indiv$group1_code <- as.character(indiv$group1)
indiv$group1_code <- fct_recode(indiv$group1_code,
"G1-I" = "1",
"G1-OM" = "2",
"G2-I" = "3",
"G2-OM" = "4",
"Autre" = "5"
)
group_qpv[which(indiv$qpv_i == 0 & group1_code=="G1-I")] = "G1-I out QPV"
group_qpv[which(indiv$qpv_i == 0 & indiv$group1_code=="G1-I")] = "G1-I out QPV"
group_qpv[which(indiv$qpv_i == 1 & indiv$group1_code=="G1-I")] = "G1-I in QPV"
group_qpv[which(indiv$qpv_i == 0 & indiv$group1_code=="Autre")] = "Autre out QPV"
group_qpv[which(indiv$qpv_i == 1 & indivgroup1_code=="Autre")] = "Autre in QPV"
group_qpv[which(indiv$qpv_i == 1 & indiv$group1_code=="Autre")] = "Autre in QPV"
coloration = c("red","orange","yellow","green","blue","purple")
l_age_inf = c(0,20,30,40,50,60)
l_age_sup = c(19,29,39,49,59,100)
for (i in 1:6){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
legend(0,1,legend=c("a moins de 29 ans","a entre 30 et 49 ans","a plus de 50 ans"),col=c("red","green","blue"),lty=c(1,1,1),cex=0.8)
par(new=T)
}
legend(0,1,legend=c("< 20 ans","> 20 et < 30 ans","> 30 et < 40 ans","> 40 et < 50 ans","> 50 et < 60 ans","> 60 ans"),col=c("red","orange","yellow","green","blue","purple"),lty=c(1,1,1,1,1,1),cex=0.8)
for (i in 1:6){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
legend(0,1,legend=c("< 20 ans","> 20 et < 30 ans","> 30 et < 40 ans","> 40 et < 50 ans","> 50 et < 60 ans","> 60 ans"),col=c("red","orange","yellow","green","blue","purple"),lty=c(1,1,1,1,1,1),cex=0.8)
par(new=T)
}
for (i in 1:6){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
legend(55,1,legend=c("< 20 ans","> 20 et < 30 ans","> 30 et < 40 ans","> 40 et < 50 ans","> 50 et < 60 ans","> 60 ans"),col=c("red","orange","yellow","green","blue","purple"),lty=c(1,1,1,1,1,1),cex=0.8)
par(new=T)
}
for (i in 1:6){ #Pour chaque groupe : traçons une courbe confiance envers la police ~ durée de sejour
age_inf = l_age_inf[i]
age_sup = l_age_sup[i]
g = group_un[1]
#durée de sejour depuis la première arrivée : $durtotfrm
#durée de sejour depuis la dernière arrivée : $durar2
data = indiv_pd2[which(indiv_pd2$variables$group1_code == g & indiv_pd2$variables$agenq >= age_inf & indiv_pd2$variables$agenq <= age_sup)]
X = 0:100
Y = c()
for (x in X){
n_tot = length(which(data$variables$durar2==x))
n_obj = length(which(data$variables$durar2==x & data$variables$i_cnfpol_rec == "Tout à fait confiance en la police")) #Avoir confiance = Tout à fait confiance
Y = c(Y,n_obj/n_tot)
}
plot(X,Y,type="l", xlim = c(0,70), ylim = c(0,1),col=coloration[i])
legend(50,1,legend=c("< 20 ans","> 20 et < 30 ans","> 30 et < 40 ans","> 40 et < 50 ans","> 50 et < 60 ans","> 60 ans"),col=c("red","orange","yellow","green","blue","purple"),lty=c(1,1,1,1,1,1),cex=0.8)
par(new=T)
}
group_qpv = rep("null",dimension[1])
group_qpv[which(indiv$qpv_i == 0 & indiv$group1_code=="G1-I")] = "G1-I out QPV"
group_qpv[which(indiv$qpv_i == 1 & indiv$group1_code=="G1-I")] = "G1-I in QPV"
group_qpv[which(indiv$qpv_i == 0 & indiv$group1_code=="Autre")] = "Autre out QPV"
group_qpv[which(indiv$qpv_i == 1 & indiv$group1_code=="Autre")] = "Autre in QPV"
indiv["group_QPV"] = group_qpv
indiv["group_qpv"]
indiv["group_QPV"]
indiv_pd2 = svydesign(ids = indiv$ident, data = indiv, weights = nouv_pond)
ggsurvey(indiv_pd2, aes(x = as.factor(group_QPV), y = nouv_pond, fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
ggsurvey(indiv_pd2[which(indiv["group_QPV"]!="null")], aes(x = as.factor(group_QPV), y = nouv_pond, fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
ggsurvey(indiv_pd2[which(indiv["group_QPV"]!="null")], aes(x = as.factor(group_QPV), y = nouv_pond[which(indiv["group_QPV"]!="null")], fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
group_qpv = rep("null",dimension[1])
qpv_pond = rep(0,dimension[1])
group_qpv[which(indiv$qpv_i == 0 & indiv$group1_code=="G1-I")] = "G1-I out QPV"
group_qpv[which(indiv$qpv_i == 1 & indiv$group1_code=="G1-I")] = "G1-I in QPV"
group_qpv[which(indiv$qpv_i == 0 & indiv$group1_code=="Autre")] = "Autre out QPV"
group_qpv[which(indiv$qpv_i == 1 & indiv$group1_code=="Autre")] = "Autre in QPV"
qpv_pond[which(indiv$qpv_i == 0 & indiv$group1_code=="G1-I")] = 1/length(which(indiv$qpv_i == 0 & indiv$group1_code=="G1-I"))
qpv_pond[which(indiv$qpv_i == 1 & indiv$group1_code=="G1-I")] = 1/length(which(indiv$qpv_i == 1 & indiv$group1_code=="G1-I"))
qpv_pond[which(indiv$qpv_i == 0 & indiv$group1_code=="Autre")] = 1/length(which(indiv$qpv_i == 0 & indiv$group1_code=="Autre"))
qpv_pond[which(indiv$qpv_i == 1 & indiv$group1_code=="Autre")] = 1/length(which(indiv$qpv_i == 1 & indiv$group1_code=="Autre"))
indiv["group_QPV"] = group_qpv
indiv_pd2 = svydesign(ids = indiv$ident, data = indiv, weights = nouv_pond)
indiv_pd2 = svydesign(ids = indiv$ident, data = indiv, weights = pond_qpv)
indiv_pd2 = svydesign(ids = indiv$ident, data = indiv, weights = qpv_pond)
ggsurvey(indiv_pd2[which(indiv["group_QPV"]!="null")], aes(x = as.factor(group_QPV), y = qpv_pond[which(indiv["group_QPV"]!="null")], fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
ggsurvey(indiv_pd, aes(x = as.factor(group_QPV), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
ggsurvey(indiv, aes(x = as.factor(group_QPV), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
ggsurvey(indiv, aes(x = as.factor(group_QPV), y = as.factor(i_cnfpol_rec) fill = as.factor(i_cnfpol_rec)))+
ggsurvey(indiv, aes(x = as.factor(group_QPV), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
ggsurvey(indiv_pd, aes(x = as.factor(group1_rec), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
ggsurvey(indiv_pd, aes(x = as.factor(group_QPV), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
ggsurvey(indiv_pd2[which(indiv["group_QPV"]!="null")], aes(x = as.factor(group_QPV), y = qpv_pond[which(indiv["group_QPV"]!="null")], fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
indiv$l_immi
indiv$l_immi_rec
## Recodage de indiv$l_immi en indiv$l_immi_rec
indiv$l_immi_rec <- as.character(indiv$l_immi)
indiv$l_immi_rec <- fct_recode(indiv$l_immi_rec,
"Presque tous sont d'origine immigree" = "1",
"Plus de la moitie est d'origine immigree" = "2",
"La moitie est d'origine immigree" = "3",
"Moins de la moitie est d'origine immigree" = "4",
"Presque pas ou aucun n'est d'origine immigree" = "5",
"Refus ou ne sait pas" = "8",
"Refus ou ne sait pas" = "9"
)
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
indiv$l_immi_rec
## Recodage de indiv$l_immi en indiv$l_immi_rec
indiv$l_immi_code <- as.character(indiv$l_immi)
indiv$l_immi_code <- fct_recode(indiv$l_immi_code,
indiv$l_immi_code <- fct_recode(indiv$l_immi_code,
"Tous" = "1",
"sup 50%" = "2",
"eq 50%" = "3",
"inf 50%" = "4",
"Aucun" = "5",
"null" = "8",
"null" = "9")
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
ggsurvey(indiv_pd, aes(x = as.factor(l_immi_code), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
immi_pond[which(indiv$l_immi_code=="Tous")] = 1/length(which(indiv$l_immi_code=="Tous"))
immi_pond = rep(0,dimension[1])
immi_pond[which(indiv$l_immi_code=="Tous")] = 1/length(which(indiv$l_immi_code=="Tous"))
immi_pond[which(indiv$l_immi_code=="sup 50%")] = 1/length(which(indiv$l_immi_code=="sup 50%"))
immi_pond[which(indiv$l_immi_code=="eq 50%")] = 1/length(which(indiv$l_immi_code=="eq 50%"))
immi_pond[which(indiv$l_immi_code=="inf 50%")] = 1/length(which(indiv$l_immi_code=="inf 50%"))
immi_pond[which(indiv$l_immi_code=="Aucun")] = 1/length(which(indiv$l_immi_code=="Aucun"))
immi_pond[which(indiv$l_immi_code=="null")] = 1/length(which(indiv$l_immi_code=="null"))
indiv_pd2 = svydesign(ids = indiv$ident, data = indiv, weights = immi_pond)
ggsurvey(indiv_pd2, aes(x = as.factor(l_immi_code), y = immi_pond, fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
immi_pond
immi_pond = rep(0,dimension[1])
immi_pond[which(indiv$l_immi_code=="Tous")] = 1/length(which(indiv$l_immi_code=="Tous"))
immi_pond[which(indiv$l_immi_code=="sup 50%")] = 1/length(which(indiv$l_immi_code=="sup 50%"))
immi_pond[which(indiv$l_immi_code=="eq 50%")] = 1/length(which(indiv$l_immi_code=="eq 50%"))
immi_pond[which(indiv$l_immi_code=="inf 50%")] = 1/length(which(indiv$l_immi_code=="inf 50%"))
immi_pond[which(indiv$l_immi_code=="Aucun")] = 1/length(which(indiv$l_immi_code=="Aucun"))
immi_pond[which(indiv$l_immi_code=="null")] = 1/length(which(indiv$l_immi_code=="null"))
indiv_pd2 = svydesign(ids = indiv$ident, data = indiv, weights = immi_pond)
ggsurvey(indiv_pd2, aes(x = as.factor(l_immi_code), y = immi_pond, fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
which(indiv$l_immi_code=="Tous")
indiv$l_immi_code
indiv$l_immi_rec
#présence d'immigrés dans le quartier (l_immi)
indiv$l_immi
## Recodage de indiv$l_immi en indiv$l_immi_rec
indiv$l_immi_code <- as.character(indiv$l_immi)
indiv$l_immi_code <- fct_recode(indiv$l_immi_code,
"Tous" = "1",
"sup 50%" = "2",
"eq 50%" = "3",
"inf 50%" = "4",
"Aucun" = "5",
"null" = "8",
"null" = "9")
immi_pond = rep(0,dimension[1])
which(indiv$l_immi_code=="Tous")
immi_pond[which(indiv$l_immi_code=="Tous")] = 1/length(which(indiv$l_immi_code=="Tous"))
immi_pond[which(indiv$l_immi_code=="sup 50%")] = 1/length(which(indiv$l_immi_code=="sup 50%"))
immi_pond[which(indiv$l_immi_code=="eq 50%")] = 1/length(which(indiv$l_immi_code=="eq 50%"))
immi_pond[which(indiv$l_immi_code=="inf 50%")] = 1/length(which(indiv$l_immi_code=="inf 50%"))
immi_pond[which(indiv$l_immi_code=="Aucun")] = 1/length(which(indiv$l_immi_code=="Aucun"))
immi_pond[which(indiv$l_immi_code=="null")] = 1/length(which(indiv$l_immi_code=="null"))
indiv_pd2 = svydesign(ids = indiv$ident, data = indiv, weights = immi_pond)
ggsurvey(indiv_pd2, aes(x = as.factor(l_immi_code), y = immi_pond, fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
pondation = function(dataset,var,labels,size=dimension[1]){
p = rep(0,size)
for (l in labels){
index = which(dataset$var==l)
p[index] = 1/length(index)
}
return(p)
}
pondation = function(dataset,var,size=dimension[1]){
labels = unique(dataset$var)
p = rep(0,size)
for (l in labels){
index = which(dataset$var==l)
p[index] = 1/length(index)
}
return(p)
}
immi_pond = pondation(indiv,l_immi_code)
immi_pond = pondation(indiv,"l_immi_code")
pondation = function(dataset,var,size=dimension[1]){
labels = unique(dataset[var])
p = rep(0,size)
for (l in labels){
index = which(dataset[var]==l)
p[index] = 1/length(index)
}
return(p)
}
immi_pond = pondation(dataset = indiv,var="l_immi_code")
pondation = function(var,size=dimension[1]){
labels = unique(var)
p = rep(0,size)
for (l in labels){
index = which(var==l)
p[index] = 1/length(index)
}
return(p)
}
immi_pond = pondation(indiv$l_immi_code)
immi_pond
indiv_pd2 = svydesign(ids = indiv$ident, data = indiv, weights = immi_pond)
ggsurvey(indiv_pd2, aes(x = as.factor(l_immi_code), y = immi_pond, fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
indiv$a_rquart
indiv$a_rquart_rec
## Recodage de indiv$l_immi en indiv$l_immi_rec
indiv$a_rquart_code <- as.character(indiv$a_rquart)
indiv$a_rquart_code <- fct_recode(indiv$a_rquart_code,
"Tous" = "1",
"sup 50%" = "2",
"eq 50%" = "3",
"inf 50%" = "4",
"Aucun" = "5",
"null" = "8",
"null" = "9")
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
ggsurvey(indiv_pd, aes(x = as.factor(l_immi_code), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
ggsurvey(indiv_pd, aes(x = as.factor(a_rquart_code), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
rquart_pond = pondation(indiv$a_rquart_code)
rquart_pond = pondation(indiv$a_rquart_code)
indiv_pd2 = svydesign(ids = indiv$ident, data = indiv, weights = rquart_pond)
ggsurvey(indiv_pd2, aes(x = as.factor(rquart_code), y = rquart_pond, fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
ggsurvey(indiv_pd2, aes(x = as.factor(a_rquart_code), y = rquart_pond, fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
indiv$l_quart_secu_rec
indiv_pd <- svydesign(ids = indiv$ident, data = indiv, weights = indiv$poidsi)
ggsurvey(indiv_pd, aes(x = as.factor(l_quart_secu_rec), y = as.factor(i_cnfpol_rec), fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
secu_pond = pondation(indiv$l_quart_secu_rec)
indiv_pd2 = svydesign(ids = indiv$ident, data = indiv, weights = secu_pond)
ggsurvey(indiv_pd2, aes(x = as.factor(l_quart_secu_rec), y = secu_pond, fill = as.factor(i_cnfpol_rec)))+
geom_bar(stat = "identity")
